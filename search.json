[{"path":"https://posit-dev.github.io/acquaint/CLAUDE.html","id":"overview","dir":"","previous_headings":"","what":"Overview","title":"NA","text":"acquaint package uses nanonext inter-process communication MCP server R sessions. nanonext provides asynchronous messaging using nanomsg/nng protocols.","code":""},{"path":[]},{"path":"https://posit-dev.github.io/acquaint/CLAUDE.html","id":"asynchronous-io-aio","dir":"","previous_headings":"Key Concepts","what":"Asynchronous I/O (Aio)","title":"NA","text":"send_aio() recv_aio() return immediately without blocking Operations complete asynchronously background Use unresolved(aio) check operation still pending Access results via aio$data (recv) aio$result (send)","code":""},{"path":"https://posit-dev.github.io/acquaint/CLAUDE.html","id":"sockets-and-communication-patterns","dir":"","previous_headings":"Key Concepts","what":"Sockets and Communication Patterns","title":"NA","text":"poly protocol: Allows multiple connections socket dial/listen: Client dials connect, server listens connections pipe IDs: poly sockets can multiplex multiple conversations","code":""},{"path":[]},{"path":"https://posit-dev.github.io/acquaint/CLAUDE.html","id":"server-process","dir":"","previous_headings":"acquaint Architecture","what":"Server Process","title":"NA","text":"MCP server (mcp_server()) runs R process : 1. Listens stdin MCP client requests 2. Maintains socket connection R sessions 3. Routes tool calls client sessions","code":""},{"path":"https://posit-dev.github.io/acquaint/CLAUDE.html","id":"session-processes","dir":"","previous_headings":"acquaint Architecture","what":"Session Processes","title":"NA","text":"Interactive R sessions (mcp_session()) connect server : 1. Listen tool execution requests server 2. Execute tools send results back 3. session gets unique ID socket connection","code":""},{"path":"https://posit-dev.github.io/acquaint/CLAUDE.html","id":"message-flow","dir":"","previous_headings":"acquaint Architecture","what":"Message Flow","title":"NA","text":"","code":"MCP Client → Server (stdin) → Session (socket) → Server → Client (stdout)"},{"path":"https://posit-dev.github.io/acquaint/CLAUDE.html","id":"server-loop-implementation","dir":"","previous_headings":"","what":"Server Loop Implementation","title":"NA","text":"server uses condition variable (cv) coordinate multiple async operations.","code":""},{"path":"https://posit-dev.github.io/acquaint/CLAUDE.html","id":"socket-urls-and-connection-management","dir":"","previous_headings":"","what":"Socket URLs and Connection Management","title":"NA","text":"Sessions listen inproc://acquaint-session-{} auto-incremented Server dials inproc://acquaint-session-1 default inproc:// transport fast -machine communication Connections cleaned nanonext::reap() exit","code":""},{"path":"https://posit-dev.github.io/acquaint/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2025 Posit Software, PBC Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://posit-dev.github.io/acquaint/articles/server.html","id":"the-basics","dir":"Articles","previous_headings":"","what":"The basics","title":"R as an MCP server","text":"context R MCP server, three main concept understand: Clients apps ’d like connect R session , like Claude Desktop Claude Code. acquaint supports client supports MCP. Clients talk R sessions using server. client supports MCP provide entry point configure command additional arguments client. acquaint’s command arguments Rscript -e \"acquaint::mcp_server()\". Different clients register command different ways. example, use acquaint client Claude Code, might write claude mcp add -s \"user\" r-acquaint -- Rscript -e \"acquaint::mcp_server()\". Sessions R sessions client ultimately talks . , RStudio Positron window open, applications automatically start R session client potentially talk . “opt ” R sessions discovered clients, run R code acquaint::mcp_session(). might want run code every time start R; , add acquaint::mcp_session() .Rprofile, perhaps first calling usethis::edit_r_profile(). Configuring sessions required; choose , tools exucuted server . (case caught eye: yes, server R session. acquaint’s documentation, ’ll always refer server R session just server; fact ’s implemented R technical detail.) case client want connect R, need configure command Rscript -e \"acquaint::mcp_server()\" according client’s instructions. Optionally, ’d like server able access variables active R sessions, add acquaint::mcp_session() .Rprofile, perhaps first calling usethis::edit_r_profile(). , ’re good go!","code":""},{"path":"https://posit-dev.github.io/acquaint/articles/server.html","id":"multiple-clients-and-r-sessions","dir":"Articles","previous_headings":"","what":"Multiple clients and R sessions","title":"R as an MCP server","text":"single client single R session probably covers many users’ use cases, acquaint supports multiple clients multiple R sessions. example, former, may chatting Claude Desktop running Claude Code terminal somewhere. , multiple R sessions situation, may two Positron instances running , different data science projects . multiple clients, “just work”; ’s nothing keep mind . multiple R sessions, acquaint choose default R session model talk without client knowing even multiple options. , might project “goats” open one Positron window another project, “sheep”, open another Positron window. acquaint provides models two tools facilitate toggling sessions. first, list_r_sessions(), allows client “discover” R sessions available working directory (inferred) IDE. , tool select_r_session() allows client (persistently) choose R session. , write “goats R session, somequestionsome question.” case, model might call list_r_sessions() find full identifier goats session, select_r_session(), whatever tools use respond question. Notably, ask follow-question (haven’t closed Positron window goats pulled meantime) client chat, client doesn’t need use list_r_sessions() select_r_session() , can just call whatever tools needs answer follow-. multiple clients multiple R sessions, generally “just work.” said, note clients can connected one R session time. clients, like Claude Code, isn’t much issue. chat apps like Claude Desktop, though, may run hiccups multiple chats actively going time. example, imagine ask Claude via Claude Desktop problem R session “goats” , moment later, spin different chat ask “sheep” project. second chat, Claude likely use select_r_session() choose “sheep” project. go back chat “goats” ask follow-, R session tool calls dispatch actually also “sheep” project. tool call, say, reads documentation, isn’t issue. tool call describe variable global environment, though, value variable may exist —different —“sheep” project.","code":""},{"path":"https://posit-dev.github.io/acquaint/articles/server.html","id":"custom-tools","dir":"Articles","previous_headings":"","what":"Custom tools","title":"R as an MCP server","text":"default, acquaint supplies clients btw::btw_tools(), set atomic tools data science btw package. tools allow clients : Peruse package documentation Describe R session information variables global environment Run queries data sources Users might interested extending tools supplying completely different ones. example, might register: set tools specifically focused R package development (e.g. various wrappers devtools testthat) hooked Claude Code make package development assistant. brave, tool run_r_code() allows client run whatever R code wants. can configure set tools passed $set_tools() method ellmer Chat object tools acquaint supply clients. , supply list outputs ellmer::tool() tools argument mcp_server(). Relatedly, ’ll need make sure code specifies new tools can run fresh R session; sure either namespace functions libraries (like ellmer::tool() instead tool()) load libraries entirely. Note , ’d like supply custom tools addition default tools btw, ’ll need set tools = (c(btw::btw_tools(), your_custom_tools)).","code":""},{"path":"https://posit-dev.github.io/acquaint/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Simon Couch. Author, maintainer. Winston Chang. Author. Charlie Gao. Author. Posit Software, PBC. Copyright holder, funder.","code":""},{"path":"https://posit-dev.github.io/acquaint/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Couch S, Chang W, Gao C (2025). acquaint: Model Context Protocol Server R Sessions. R package version 0.0.0.9000, https://github.com/posit-dev/acquaint.","code":"@Manual{,   title = {acquaint: Model Context Protocol Server For Your R Sessions},   author = {Simon Couch and Winston Chang and Charlie Gao},   year = {2025},   note = {R package version 0.0.0.9000},   url = {https://github.com/posit-dev/acquaint}, }"},{"path":"https://posit-dev.github.io/acquaint/index.html","id":"acquaint-","dir":"","previous_headings":"","what":"Model Context Protocol Server For Your R Sessions","title":"Model Context Protocol Server For Your R Sessions","text":"acquaint implements Model Context Protocol (MCP) server R sessions. configured acquaint, MCP-enabled tools like Claude Desktop Claude Code can run R code sessions running answer questions. package supports configuring arbitrary R functions, acquaint provides default set tools btw : Peruse documentation packages installed, Check objects global environment, Retrieve metadata session platform. IMPORTANT: package highly experimental interface may change rapidly!","code":""},{"path":"https://posit-dev.github.io/acquaint/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Model Context Protocol Server For Your R Sessions","text":"can install development version acquaint like : acquaint can hooked application supports MCP. example, use Claude Desktop, might paste following Claude Desktop configuration (macOS, ~/Library/Application Support/Claude/claude_desktop_config.json): , use Claude Code, might type terminal: , ’d like models access variables specific R sessions, call acquaint::mcp_session() sessions. (might include call function .Rprofile, perhaps using usethis::edit_r_profile(), automatically register every session start .) thorough introduction, see vignette “Getting started acquaint” vignette(\"acquaint\", package = \"acquaint\").","code":"pak::pak(\"posit-dev/acquaint\") {   \"mcpServers\": {     \"r-acquaint\": {       \"command\": \"Rscript\",       \"args\": [\"-e\", \"acquaint::mcp_server()\"]     }   } } claude mcp add -s \"user\" r-acquaint -- Rscript -e \"acquaint::mcp_server()\""},{"path":"https://posit-dev.github.io/acquaint/index.html","id":"example","dir":"","previous_headings":"","what":"Example","title":"Model Context Protocol Server For Your R Sessions","text":"Claude Desktop, ’ll write following: Using R packages installed, write code download data flights /Chicago airports 2024. typical chat interface, ’d wary two failure points : model doesn’t know packages installed. model correctly guesses packages installed, may enough information use packages baked weights write correct code.  first searching installed packages, Claude can locate anyflights package, seems like reasonable solution. model discovers package’s anyflights() function reads documentation, can pattern-match write correct code.","code":""},{"path":"https://posit-dev.github.io/acquaint/reference/acquaint-package.html","id":null,"dir":"Reference","previous_headings":"","what":"acquaint: Model Context Protocol Server For Your R Sessions — acquaint-package","title":"acquaint: Model Context Protocol Server For Your R Sessions — acquaint-package","text":"Implements model context protocol (MCP) server R sessions, allowing MCP-compatible apps like Claude Desktop Claude Code run R code active R sessions order better answer questions. default, package supplies set tools allow models inspect R environment peruse package documentation, supports arbitrary R functions tools.","code":""},{"path":[]},{"path":"https://posit-dev.github.io/acquaint/reference/acquaint-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"acquaint: Model Context Protocol Server For Your R Sessions — acquaint-package","text":"Maintainer: Simon Couch simon.couch@posit.co (ORCID) Authors: Winston Chang winston@posit.co Charlie Gao charlie.gao@posit.co (ORCID) contributors: Posit Software, PBC (03wc8by49) [copyright holder, funder]","code":""},{"path":"https://posit-dev.github.io/acquaint/reference/client.html","id":null,"dir":"Reference","previous_headings":"","what":"Define ellmer tools from MCP servers — client","title":"Define ellmer tools from MCP servers — client","text":"functions implement R MCP client, ellmer chats can register functionality third-party MCP servers listed : https://github.com/modelcontextprotocol/servers. mcp_tools() fetches tools MCP servers configured acquaint server config file converts list tools compatible $set_tools() method ellmer::Chat objects.","code":""},{"path":"https://posit-dev.github.io/acquaint/reference/client.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Define ellmer tools from MCP servers — client","text":"","code":"mcp_tools(path = NULL)"},{"path":"https://posit-dev.github.io/acquaint/reference/client.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Define ellmer tools from MCP servers — client","text":"path single string indicating path acquaint MCP servers configuration file. one supplied, acquaint look one file path configured option .acquaint_config, falling back file.path(\"~\", \".config\", \"acquaint\", \"config.json\").","code":""},{"path":"https://posit-dev.github.io/acquaint/reference/client.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Define ellmer tools from MCP servers — client","text":"mcp_tools() returns list ellmer tools can passed directly $set_tools() method ellmer::Chat object. file path exist, error.","code":""},{"path":"https://posit-dev.github.io/acquaint/reference/client.html","id":"configuration","dir":"Reference","previous_headings":"","what":"Configuration","title":"Define ellmer tools from MCP servers — client","text":"acquaint uses .json configuration file format Claude Desktop; MCP servers define example .json configure server Claude Desktop README files. default, acquaint look file.path(\"~\", \".config\", \"acquaint\", \"config.json\"); can edit file file.edit(file.path(\"~\", \".config\", \"acquaint\", \"config.json\")). acquaint config file valid .json entry mcpServers. entry contain named elements, least command args entry. example, configure mcp_tools() GitHub's official MCP Server https://github.com/github/github-mcp-server, write following file:","code":"{   \"mcpServers\": {     \"github\": {       \"command\": \"docker\",       \"args\": [         \"run\",         \"-i\",         \"--rm\",         \"-e\",         \"GITHUB_PERSONAL_ACCESS_TOKEN\",         \"ghcr.io/github/github-mcp-server\"       ],       \"env\": {         \"GITHUB_PERSONAL_ACCESS_TOKEN\": \"<add_your_github_pat_here>\"       }     }   } }"},{"path":[]},{"path":"https://posit-dev.github.io/acquaint/reference/server.html","id":null,"dir":"Reference","previous_headings":"","what":"Model context protocol for your R session — mcp_server","title":"Model context protocol for your R session — mcp_server","text":"Together, functions implement model context protocol server R session.","code":""},{"path":"https://posit-dev.github.io/acquaint/reference/server.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Model context protocol for your R session — mcp_server","text":"","code":"mcp_server(tools = btw::btw_tools())  mcp_session()"},{"path":"https://posit-dev.github.io/acquaint/reference/server.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Model context protocol for your R session — mcp_server","text":"tools list tools created ellmer::tool() available server. list passed Chat$set_tools() can passed . default, package use btw::btw_tools().","code":""},{"path":"https://posit-dev.github.io/acquaint/reference/server.html","id":"configuration","dir":"Reference","previous_headings":"","what":"Configuration","title":"Model context protocol for your R session — mcp_server","text":"mcp_server() configured MCP clients via Rscript command. example, use Claude Desktop, paste following Claude Desktop configuration (macOS, file.edit(\"~/Library/Application Support/Claude/claude_desktop_config.json\")):   , use Claude Code, might type terminal:   mcp_server() intended interactive use. server interfaces MCP client behalf R session. Use mcp_session() make R session available server. Place call acquaint::mcp_session() .Rprofile, perhaps usethis::edit_r_profile(), make every interactive R session start available server.","code":"{   \"mcpServers\": {     \"r-acquaint\": {       \"command\": \"Rscript\",       \"args\": [\"-e\", \"acquaint::mcp_server()\"]     }   } } claude mcp add -s \"user\" r-acquaint Rscript -e \"acquaint::mcp_server()\""},{"path":[]},{"path":"https://posit-dev.github.io/acquaint/reference/server.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Model context protocol for your R session — mcp_server","text":"","code":"# should only be run non-interactively, and will block the current R process # once called. if (FALSE) { # to just start a server with btw tools: mcp_server()  # to do so with non-default tools: library(ellmer)  tool_rnorm <- tool(   rnorm,   \"Draw numbers from a random normal distribution\",   n = type_integer(\"The number of observations. Must be a positive integer.\"),   mean = type_number(\"The mean value of the distribution.\"),   sd = type_number(\"The standard deviation of the distribution. Must be a non-negative number.\") )  mcp_server(tools = list(tool_rnorm)) } if (interactive()) { mcp_session() }"}]
